<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            React Native 集成原生组件（Android） | 
        
        lennyup&#39;s Notes
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="lennyup">
    <meta name="description" content="不得了">
    <meta name="keywords" content="“不得了”">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="lennyup&#39;s Notes">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://lennyup.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="React Native 集成原生组件（Android） | lennyup&#39;s Notes">
    <meta property="og:description" content="不得了">
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body {
        /*background-color: #F5F5F5;*/
         background-image: url(https://api.i-meto.com/bing?color=white);
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text {
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    
        <script type="text/javascript">
            queue.offer(function(){
                $('body').attr('data-original', 'https://api.i-meto.com/bing?color=white');
                $('body.lazy').lazyload();
            });
        </script>
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#一、前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">一、前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#二、主要步骤"><span class="post-toc-number">2.</span> <span class="post-toc-text">二、主要步骤</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1、原生组件"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1、原生组件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2、创建ViewManager子类"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2、创建ViewManager子类</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3、使用-ReactProp-或者-ReactPropGroup-注解相关方法对外可以被调用设置属性"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3、使用@ReactProp(或者@ReactPropGroup)注解相关方法对外可以被调用设置属性</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4、事件"><span class="post-toc-number">3.</span> <span class="post-toc-text">4、事件</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5、创建-Event"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">5、创建 Event</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6、创建Package，注册Manager"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">6、创建Package，注册Manager</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7、Application添加-Package"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">7、Application添加 Package</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8、实现JavaScript模块"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">8、实现JavaScript模块</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#总结"><span class="post-toc-number">4.</span> <span class="post-toc-text">总结</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参考资料"><span class="post-toc-number">5.</span> <span class="post-toc-text">参考资料</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                React Native 集成原生组件（Android）
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>lennyup</strong>
        <span>9月 15, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2017/09/15/rn-native/" class="leancloud-views_num" data-flag-title="React Native 集成原生组件（Android）">
     &nbsp;阅读量
</span>

            </li>
        </a>
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        阅读量&nbsp;<span id="busuanzi_value_page_pv"></span>
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=React Native 集成原生组件（Android）&url=https://lennyup.github.io//2017/09/15/rn-native/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=React Native 集成原生组件（Android）&url=https://lennyup.github.io//2017/09/15/rn-native/index.html&via=lennyup" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://lennyup.github.io//2017/09/15/rn-native/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://lennyup.github.io//2017/09/15/rn-native/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h3 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h3><p> 最近一直在做公司项目的 4.0 版本重构，在重构中有一个需求，要求对<code>FlatList</code>的下拉刷新做统一的修改，就是要达到<code>Android</code>和<code>IOS</code>的效果一致(emmmm), <code>React Native</code>官方给的样式是两端不一样的效果，在<code>Android</code>端，是用的<code>Swiperefresh</code>。在网上搜到的一些都是很久没有更新的git项目或者就是达不到我们高大上的 UI的要求，于是乎，我走上了封装原生组件的道路。下面我说下我进行封装的几个步骤。</p>
<h3 id="二、主要步骤"><a href="#二、主要步骤" class="headerlink" title="二、主要步骤"></a>二、主要步骤</h3><h4 id="1、原生组件"><a href="#1、原生组件" class="headerlink" title="1、原生组件"></a>1、原生组件</h4><p>第一步，我们需要一个自己的原生组件，然后对组件进行包装。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public class PullRefreshLayout extends ViewGroup &#123;</div><div class="line">	....</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这是我自己写的下拉刷新的原生组件，至于自定义<code>ViewGroup</code>这里就不过多概述了。</p>
<h4 id="2、创建ViewManager子类"><a href="#2、创建ViewManager子类" class="headerlink" title="2、创建ViewManager子类"></a>2、创建ViewManager子类</h4><p>因为我这里的组件是<code>ViewGroup</code>,所有我的<code>ViewManager</code>要继承<code>ViewGroupManager</code>,如果是<code>View</code>的话，就是<code>SimpleViewManager</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">public class PullRefreshLayoutManager extends ViewGroupManager&lt;PullRefreshLayout&gt; &#123;</div><div class="line"></div><div class="line">    protected static final String REACT_CLASS = &quot;RCTPullRefreshLayout&quot;;</div><div class="line"></div><div class="line">    protected static final String TYPE_REFRESH = &quot;refreshFunc&quot;;</div><div class="line"></div><div class="line">    protected static final String TYPE_DRAG = &quot;onDrag&quot;;</div><div class="line"></div><div class="line">    public static final String PROP_REFRESHING = &quot;isRefreshing&quot;;</div><div class="line">    private ThemedReactContext aContext;</div><div class="line">    @Override</div><div class="line">    public String getName() &#123;</div><div class="line">        return REACT_CLASS;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    protected PullRefreshLayout createViewInstance(ThemedReactContext reactContext) &#123;</div><div class="line">        this.aContext = reactContext;</div><div class="line">        final PullRefreshLayout layout = new PullRefreshLayout(reactContext);</div><div class="line">        layout.setRefreshDrawable(new XeDrawable(reactContext, layout));</div><div class="line">        final EventDispatcher mEventDispatcher = reactContext.</div><div class="line">                getNativeModule(UIManagerModule.class).getEventDispatcher();</div><div class="line">        layout.setOnRefreshListener(new PullRefreshLayout.OnRefreshListener() &#123;</div><div class="line">            @Override</div><div class="line">            public void onRefresh() &#123;</div><div class="line">                mEventDispatcher.dispatchEvent(new LayoutRefreshEvent(layout.getId(), TYPE_REFRESH));</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            @Override</div><div class="line">            public void onDrag(float percent) &#123;</div><div class="line">                mEventDispatcher.dispatchEvent(new LayoutRefreshEvent(layout.getId(), TYPE_DRAG, percent));</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        return layout;</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>这里必须重写的两个方法 <code>getName</code>和<code>createViewInstance</code>，<br><code>getName</code>方法返回的名字用于该在JavaScript中进行调用</p>
<p>视图会通过<code>createViewInstance</code>方法进行创建，同时会被初始化为默认状态。然后属性的话 会通过<code>updateView</code>方法进行更新,所以我们一般对齐做一些初始化的东西，我这里是设置下拉刷新的样式以及刷新的回调，<br>细心的大佬们可能会发现，这里有一个 <code>EventDispatcher</code>,这个在以后会讲到。</p>
<h4 id="3、使用-ReactProp-或者-ReactPropGroup-注解相关方法对外可以被调用设置属性"><a href="#3、使用-ReactProp-或者-ReactPropGroup-注解相关方法对外可以被调用设置属性" class="headerlink" title="3、使用@ReactProp(或者@ReactPropGroup)注解相关方法对外可以被调用设置属性"></a>3、使用@ReactProp(或者@ReactPropGroup)注解相关方法对外可以被调用设置属性</h4><p>有时候我们会看到有一些RN的组件的一些属性，比如说<code>Image</code>的<code>src</code>,如果需要提供属性方便在JavaScript中调用的话，那么需要设置方法使用@ReactProp(或者@ReactPropGroup)进行注解，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">@ReactProp(name = PROP_REFRESHING)</div><div class="line"> public void setRefresing (PullRefreshLayout layout, boolean isRefreshing) &#123;</div><div class="line">     layout.setRefreshing(isRefreshing);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>设置方法的第一个参数就是实例本身，第二个参数就是需要设置的属性值。该方法的返回值必须是void，访问权限必须是public。其中在JavaScript的获取的属性的类型由第二个参数的类型决定。其支持的类型为：<code>boolean</code>、<code>int</code>、<code>float</code>、<code>String</code>、<code>Boolean</code>、<code>Integer</code>、<code>ReadableArray</code>、<code>ReadableMap</code></p>
<p>使用@ReactProp注解的 name是指向JavaScript中的调用的属性名。<br>除了name之外，@ReactProp注解还接受一些其他属性，例如：<code>defaultBoolean、</code>defaultInt<code>、</code>defaultFloat`。其对应的类型必须是（boolean，int，float）null为默认值。</p>
<p>@ReactPropGroup注解的使用方法，目前我还没搞明白，等以后搞明白，我会及时补充的。</p>
<h3 id="4、事件"><a href="#4、事件" class="headerlink" title="4、事件"></a>4、事件</h3><p>这里，我举个例子，在<code>Image</code>使用中，有一个<code>onLoad</code>，我们可以在其回调的时候写自己的逻辑，那么我们在自己封装的时候如果也有着样的需求的话该如何做呢？ </p>
<p>这里就要说我们之后留了一个悬念的<code>EventDispatcher</code>,我们先看下代码，可能会更加直观一点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">final EventDispatcher mEventDispatcher = reactContext.</div><div class="line">         getNativeModule(UIManagerModule.class).getEventDispatcher();</div><div class="line"> layout.setOnRefreshListener(new PullRefreshLayout.OnRefreshListener() &#123;</div><div class="line">     @Override</div><div class="line">     public void onRefresh() &#123;</div><div class="line">         mEventDispatcher.dispatchEvent(new LayoutRefreshEvent(layout.getId(), TYPE_REFRESH));</div><div class="line">     &#125;</div><div class="line"></div><div class="line">     @Override</div><div class="line">     public void onDrag(float percent) &#123;</div><div class="line">         mEventDispatcher.dispatchEvent(new LayoutRefreshEvent(layout.getId(), TYPE_DRAG, percent));</div><div class="line">     &#125;</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p>这个事件名<code>onRefresh</code>在JavaScript端映射到<code>onRefresh</code>回调属性上（这两个是通过 getId关联在一起的）</p>
<h4 id="5、创建-Event"><a href="#5、创建-Event" class="headerlink" title="5、创建 Event"></a>5、创建 Event</h4><p>当然 这个不是必须的，但是我还是建议创建。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">public class LayoutRefreshEvent extends Event&lt;LayoutRefreshEvent&gt;&#123;</div><div class="line"></div><div class="line">    private final String mEventType;</div><div class="line"></div><div class="line">    private static float mPercent;</div><div class="line"></div><div class="line">    public LayoutRefreshEvent(int viewId, String mEventType) &#123;</div><div class="line">        super(viewId);</div><div class="line">        this.mEventType = mEventType;</div><div class="line">        this.mPercent = 1f;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    public LayoutRefreshEvent(int viewTag, String mEventType, float mPercent) &#123;</div><div class="line">        super(viewTag);</div><div class="line">        this.mEventType = mEventType;</div><div class="line">        this.mPercent = mPercent;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public String getEventName() &#123;</div><div class="line">        return mEventType;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void dispatch(RCTEventEmitter rctEventEmitter) &#123;</div><div class="line">        WritableMap eventData = Arguments.createMap();</div><div class="line">        eventData.putDouble(&quot;percent&quot;, mPercent);</div><div class="line">        rctEventEmitter.receiveEvent(getViewTag(), getEventName(), eventData);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>连个构造方法我就不多说了， 这里说下 <code>getEventName</code>和<code>dispath</code><br><code>getEventName</code>返回我们映射到JavaScript上的哪个毁掉属性上，<br>看下这句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rctEventEmitter.receiveEvent(getViewTag(), getEventName(), eventData);</div></pre></td></tr></table></figure>
<p>这里最主要的部分，这句的意思是 携带参数映射到JavaScript上，稍后我们看下 JavaScript上如何做。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mEventDispatcher.dispatchEvent(new LayoutRefreshEvent(layout.getId(), TYPE_REFRESH));</div></pre></td></tr></table></figure>
<h4 id="6、创建Package，注册Manager"><a href="#6、创建Package，注册Manager" class="headerlink" title="6、创建Package，注册Manager"></a>6、创建Package，注册Manager</h4><p>这里就应该比较熟悉了，封装原生的东西 都会创建的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class PullRefreshLayoutPackage  implements ReactPackage&#123;</div><div class="line">    @Override</div><div class="line">    public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) &#123;</div><div class="line">        return Collections.emptyList();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public List&lt;Class&lt;? extends JavaScriptModule&gt;&gt; createJSModules() &#123;</div><div class="line">        return Collections.emptyList();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) &#123;</div><div class="line">        return Arrays.&lt;ViewManager&gt;asList(new PullRefreshLayoutManager());</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 这次，我们创建的不是 Module，我们的注册要放在 Managers里，如上。</p>
<h4 id="7、Application添加-Package"><a href="#7、Application添加-Package" class="headerlink" title="7、Application添加 Package"></a>7、Application添加 Package</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">protected List&lt;ReactPackage&gt; getPackages() &#123;</div><div class="line">  return Arrays.&lt;ReactPackage&gt;asList(</div><div class="line">          new MainReactPackage(),</div><div class="line">...</div><div class="line">new PullRefreshLayoutPackage()</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="8、实现JavaScript模块"><a href="#8、实现JavaScript模块" class="headerlink" title="8、实现JavaScript模块"></a>8、实现JavaScript模块</h4><p>下面最后一步就是创建JavaScript层，定义Java和JavaScript的接口层。大部分的功能都是通过React 底层的Java和Javas进行完成下面就是说需要使用propType属性进行设置属性的类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;</div><div class="line">import &#123;</div><div class="line">  View,</div><div class="line">  requireNativeComponent</div><div class="line">&#125; from &apos;react-native&apos;</div><div class="line"></div><div class="line">let PullRefreshLayout = &#123;</div><div class="line">  displayName: &apos;PullRefreshLayout&apos;,</div><div class="line">  propTypes: &#123;</div><div class="line">    isRefreshing: React.PropTypes.bool,</div><div class="line">    refreshFunc: React.PropTypes.func,</div><div class="line">    onDrag: React.PropTypes.func,</div><div class="line">    ...View.propTypes  // 支持View组件的所有属性</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">const RCTPullRefreshLayout = requireNativeComponent(&apos;RCTPullRefreshLayout&apos;, PullRefreshLayout)</div><div class="line"></div><div class="line">export default RCTPullRefreshLayout</div></pre></td></tr></table></figure>
<p>requireNativeComponent会接受两个参数，第一个参数就是之前我们getName方法返回的名称（代表视图的名字），第二个参数表示描述设置的对象。当前对象的name的值必须设置恰当，因为该值会在调试中进行打印。该对象海需要进行声明propType字段，用来反映原生视图。同时propTyes对象可以用来检查用户使用的原生视图的正确与否。</p>
<p>如果你需要进行一些自定义的事件，那么你可以通过一个普通的React组件进行封装原生组件，那么requireNativeComponent的第二个参数可以传入封装的组件而不是我们上面的<code>PullRefreshLayout</code>,这里我们看下官网给的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">class MyCustomView extends View &#123;</div><div class="line">   ...</div><div class="line">   public void onReceiveNativeEvent() &#123;</div><div class="line">      WritableMap event = Arguments.createMap();</div><div class="line">      event.putString(&quot;message&quot;, &quot;MyMessage&quot;);</div><div class="line">      ReactContext reactContext = (ReactContext)getContext();</div><div class="line">      reactContext.getJSModule(RCTEventEmitter.class).receiveEvent(</div><div class="line">          getId(),</div><div class="line">          &quot;topChange&quot;,</div><div class="line">          event);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">class MyCustomView extends React.Component &#123;</div><div class="line">  constructor() &#123;</div><div class="line">    this._onChange = this._onChange.bind(this);</div><div class="line">  &#125;</div><div class="line">  _onChange(event: Event) &#123;</div><div class="line">    if (!this.props.onChangeMessage) &#123;</div><div class="line">      return;</div><div class="line">    &#125;</div><div class="line">    this.props.onChangeMessage(event.nativeEvent.message);</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    return &lt;RCTMyCustomView &#123;...this.props&#125; onChange=&#123;this._onChange&#125; /&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">MyCustomView.propTypes = &#123;</div><div class="line">  /**</div><div class="line">   * Callback that is called continuously when the user is dragging the map.</div><div class="line">   */</div><div class="line">  onChangeMessage: React.PropTypes.func,</div><div class="line">  ...</div><div class="line">&#125;;</div><div class="line"></div><div class="line">var RCTMyCustomView = requireNativeComponent(`RCTMyCustomView`, MyCustomView, &#123;</div><div class="line">  nativeOnly: &#123;onChange: true&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>可以看到，上面用到<code>nativeOnly</code> 。有时候有一些特殊的属性，想从原生组件中导出，但是又不希望它们成为对应React封装组件的属性。举个例子，<code>Switch</code>组件可能在原生组件上有一个<code>onChange</code>事件，然后在封装类中导出<code>onValueChange</code>回调属性。这个属性在调用的时候会带上Switch的状态作为参数之一。这样的话你可能不希望原生专用的属性出现在API之中，也就不希望把它放到propType里。可是如果你不放的话，优惠出现一个报错。解决方案就是带上<code>nativeOnly</code>选项。（ps： 这是官网的原话，我觉得比我自己说的话要好，就直接拿过来了）</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>这里只是介绍了 android端封装原生组件的步骤，记得但开始做这个的时候，脑子一片空白，然后各种查资料。果然是书到用时方恨少！！！！！</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://reactnative.cn/docs/0.48/native-component-android.html#content" target="_blank" rel="external">原生UI组件-官网</a></p>
<p><a href="https://juejin.im/entry/5724249671cfe400576a21f9" target="_blank" rel="external">React Native 进阶之原生 UI 组件封装详解</a></p>
<p><a href="http://www.jianshu.com/p/f26d994ea765" target="_blank" rel="external">React-Native之Android:封装原生UI组件</a></p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用多说评论 -->
    <link rel="stylesheet" href="/css/duoshuo.min.css">
<style>
    #ds-thread #ds-reset .ds-post-button{
        background-color: #0097A7 !important;
    }
    #ds-wrapper #ds-reset .ds-icons-32{
        background-color: #0097A7 !important;
    }
    #ds-reset .ds-highlight {
        color: #0097A7 !important;
    }
</style>
<div id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread"
        data-thread-key="2017/09/15/rn-native/"
        data-url="https://lennyup.github.io/2017/09/15/rn-native/"
        data-title="React Native 集成原生组件（Android）" id="ds-thread">
    </div>
    <!-- 多说评论框 end -->
</div>






                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/09/20/android-interview/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/06/09/file-provider/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="lennyup's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        jsonlenny@163.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">六月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">4</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;lennyup's Notes
            <div>
		            <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
		            <div>
		                本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp
		                  你是第<span id="busuanzi_value_site_uv"></span>个来到的小伙伴
		           </div>
		       </div>
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize('WPJ4R6qYeJQjJl3KmMAJoME0-gzGzoHsz', 'iRC9fkt9xkx9KoqFepPypBJP');
    </script>
    <script>
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>




    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



    <!-- 多说公共 js 代码 start -->
    <script type="text/javascript">
        queue.offer(function(){
            window.duoshuoQuery = {
                short_name: 'lennyupio'
            };
            (function() {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';
                ds.async = true;
                ds.src = 'https://static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0]
                 || document.getElementsByTagName('body')[0]).appendChild(ds);
            })();
        });
    </script>
    <!-- 多说公共 js 代码 end -->





<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
